{% extends "accounts/settings/base_settings.html" %}
{% load static %}

{% block title %}Zm캩na e-mailu - Nastaven칤 - QuietPage{% endblock %}

{% block settings_content %}
<div class="settings-page">
    <header class="settings-page-header">
        <h1>Zm캩na e-mailov칠 adresy</h1>
        <p class="text-muted">Aktualizujte svou e-mailovou adresu</p>
    </header>
    
    <!-- Pending Email Change Request -->
    {% if pending_request %}
    <div class="info-box" style="border-left-color: var(--primary); margin-bottom: 2rem;">
        <h3>游닎 캛ek치me na potvrzen칤</h3>
        <p>Poslali jsme verifika캜n칤 odkaz na <strong>{{ pending_request.new_email }}</strong></p>
        <p class="text-muted" style="font-size: 0.875rem; margin-top: 0.5rem;">
            Odkaz vypr코칤 {{ pending_request.expires_at|date:"j. n. Y v H:i" }}
        </p>
        
        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
            <form method="post" action="{% url 'accounts:email-resend' %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-secondary" style="font-size: 0.875rem; padding: 0.5rem 1rem;">
                    Znovu odeslat
                </button>
            </form>
            
            <form method="post" action="{% url 'accounts:email-cancel' %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-secondary" style="font-size: 0.875rem; padding: 0.5rem 1rem;">
                    Zru코it 쮂멳ost
                </button>
            </form>
        </div>
    </div>
    {% endif %}
    
    <form method="post" class="settings-form">
        {% csrf_token %}
        
        <!-- Current Email (Read-only) -->
        <section class="form-section">
            <h2 class="form-section-title">Sou캜asn칳 e-mail</h2>
            
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Va코e sou캜asn치 e-mailov치 adresa</span>
                    <span class="info-value">{{ current_email }}</span>
                </div>
            </div>
        </section>
        
        <!-- New Email Form -->
        <section class="form-section">
            <h2 class="form-section-title">Nov칳 e-mail</h2>
            
            <div class="form-group">
                <label for="{{ form.new_email.id_for_label }}" class="form-label">
                    {{ form.new_email.label }}
                </label>
                {{ form.new_email }}
                {% if form.new_email.help_text %}
                    <p class="form-help">{{ form.new_email.help_text }}</p>
                {% endif %}
                {% if form.new_email.errors %}
                    <div class="form-errors">
                        {% for error in form.new_email.errors %}
                            <p class="form-error">{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
            
            <div class="form-group">
                <label for="{{ form.password.id_for_label }}" class="form-label">
                    {{ form.password.label }}
                </label>
                {{ form.password }}
                {% if form.password.help_text %}
                    <p class="form-help">{{ form.password.help_text }}</p>
                {% endif %}
                {% if form.password.errors %}
                    <div class="form-errors">
                        {% for error in form.password.errors %}
                            <p class="form-error">{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </section>
        
        <!-- Warning Box -->
        <div class="info-box" style="border-left-color: var(--primary);">
            <h3>D콢le쬴t칠 upozorn캩n칤</h3>
            <ul>
                <li>Po코leme verifika캜n칤 odkaz na novou e-mailovou adresu</li>
                <li>E-mail bude zm캩n캩n a po kliknut칤 na odkaz v e-mailu</li>
                <li>Verifika캜n칤 odkaz vypr코칤 za 24 hodin</li>
                <li>Nov칳 e-mail budete pou쮂셨at pro obnoven칤 hesla</li>
            </ul>
        </div>
        
        <!-- Form Actions -->
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                Zm캩nit e-mail
            </button>
            <a href="{% url 'accounts:settings-profile' %}" class="btn btn-secondary">
                Zru코it
            </a>
        </div>
    </form>
</div>
{% endblock %}
